name: Test
on: push
jobs:
  run-tests:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Start containers
      run: npm run compose:ci
      
    - name: Sleep for 30 seconds
      run: sleep 30

    - name: Get mocha logs
      run: docker logs test-runner

    - name: Stop containers
      if: always()
      run: docker-compose --env-file .env.dev -f ./docker-compose.ci.yml down